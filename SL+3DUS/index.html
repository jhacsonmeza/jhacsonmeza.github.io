<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>SL+3DUS</title>
    
    <link href="style.css" rel="stylesheet">
    <link href="//fonts.cdnfonts.com/css/avenir-lt-std" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Montserrat:700" rel="stylesheet">

    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script type="module" src="js/3dviz.js"></script>

    <script type="module" src="../js/medium-zoom.js"></script>
    <script type="module">
        mediumZoom(document.querySelectorAll('.zoom-fig'))
    </script>
</head>
<body>

    <canvas id="c"></canvas>

    <div class="paper-title">
        Three-dimensional multimodal medical imaging system based on free-hand ultrasound and structured light
    </div>

    <div class="authors">
        <div class="author"><a href="https://jhacsonmeza.github.io/" target="_blank">Jhacson Meza</a></div>
        <div class="author"><a href="https://scholar.google.com.co/citations?user=JoCZVakAAAAJ&hl=en" target="_blank">Sonia H. Contreras-Ortiz</a></div>
        <div class="author"><a href="https://scholar.google.com/citations?user=pPcGyLsAAAAJ&hl=en" target="_blank">Lenny A. Romero</a></div>
        <div class="author"><a href="https://scholar.google.com/citations?user=TH8nMmUAAAAJ&hl=en" target="_blank">Andres G. Marrugo</a></div>

        <div class="afiliation">
            <a href="https://www.utb.edu.co/" target="_blank">Universidad Tecnológica de Bolívar</a>
        </div>
    </div>

    
    <div class="paper-links">
        <a href="https://arxiv.org/pdf/2105.14355.pdf" target="_blank">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-pdf" viewBox="0 0 16 16">
                <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"/>
                <path d="M4.603 14.087a.81.81 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.68 7.68 0 0 1 1.482-.645 19.697 19.697 0 0 0 1.062-2.227 7.269 7.269 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a10.954 10.954 0 0 0 .98 1.686 5.753 5.753 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.856.856 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.712 5.712 0 0 1-.911-.95 11.651 11.651 0 0 0-1.997.406 11.307 11.307 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.793.793 0 0 1-.58.029zm1.379-1.901c-.166.076-.32.156-.459.238-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361.01.022.02.036.026.044a.266.266 0 0 0 .035-.012c.137-.056.355-.235.635-.572a8.18 8.18 0 0 0 .45-.606zm1.64-1.33a12.71 12.71 0 0 1 1.01-.193 11.744 11.744 0 0 1-.51-.858 20.801 20.801 0 0 1-.5 1.05zm2.446.45c.15.163.296.3.435.41.24.19.407.253.498.256a.107.107 0 0 0 .07-.015.307.307 0 0 0 .094-.125.436.436 0 0 0 .059-.2.095.095 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a3.876 3.876 0 0 0-.612-.053zM8.078 7.8a6.7 6.7 0 0 0 .2-.828c.031-.188.043-.343.038-.465a.613.613 0 0 0-.032-.198.517.517 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822.024.111.054.227.09.346z"/>
            </svg><br>PDF
        </a>
        <a href="https://doi.org/10.1117/1.OE.60.5.054106" target="_blank">
            <svg id="icon-doi" viewBox="0 0 32 32" fill="currentColor">
                <path d="M6.941 13.839c-0.627 0-1.209 0.456-1.612 0.93-0.327 0.384-0.49 0.976-0.49 1.469s0.185 1.041 0.512 1.425c0.397 0.474 0.824 0.798 1.458 0.798 0.57 0 1.248-0.239 1.638-0.63 0.397-0.391 0.727-1.046 0.727-1.616 0-0.563-0.155-1.238-0.551-1.628-0.397-0.397-1.119-0.749-1.682-0.749zM18.209 13.994c-0.653 0-1.184 0.257-1.594 0.77-0.333 0.412-0.499 0.881-0.499 1.408 0 0.534 0.167 1.006 0.499 1.418 0.41 0.513 0.941 0.77 1.594 0.77 0.583 0 1.075-0.21 1.479-0.629 0.403-0.426 0.605-0.945 0.605-1.56 0-0.608-0.205-1.121-0.615-1.54-0.403-0.425-0.893-0.639-1.469-0.639zM16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16-7.163 16-16s-7.163-16-16-16zM12.205 20.89h-2.964v-1.206c-0.301 0.378-1.009 0.763-1.316 0.936-0.538 0.301-1.268 0.497-1.953 0.497-1.108 0-2.093-0.35-2.958-1.112-1.031-0.909-1.515-2.299-1.515-3.797 0-1.524 0.528-2.74 1.585-3.649 0.839-0.723 1.864-1.303 2.953-1.303 0.634 0 1.415 0.057 1.972 0.326 0.32 0.154 0.893 0.515 1.233 0.867v-6.355h2.964v14.796zM22.348 19.526c-0.986 1.135-2.366 1.702-4.139 1.702-1.78 0-3.163-0.567-4.149-1.702-0.813-0.932-1.22-2.077-1.22-3.435 0-1.223 0.41-2.307 1.229-3.252 0.992-1.141 2.404-1.712 4.235-1.712 1.684 0 3.028 0.571 4.033 1.712 0.819 0.932 1.229 2.043 1.229 3.333 0 1.304-0.406 2.421-1.219 3.353zM24.849 6.673c0.346-0.346 0.765-0.519 1.258-0.519s0.912 0.173 1.258 0.519c0.346 0.339 0.519 0.755 0.519 1.248 0 0.499-0.173 0.922-0.519 1.268-0.339 0.339-0.759 0.509-1.258 0.509-0.493 0-0.912-0.173-1.258-0.519-0.339-0.346-0.509-0.765-0.509-1.258s0.17-0.909 0.509-1.248zM27.682 20.882h-3.15v-9.409h3.15z"></path>
            </svg><br>DOI
        </a>
        <a href="https://arxiv.org/abs/2105.14355" target="_blank">
            <svg id="icon-arxiv" viewBox="0 0 32 32" fill="currentColor">
                <path d="M13.687 12.152c0 1.267-0.478 2.293-1.067 2.293s-1.067-1.027-1.067-2.293c0-1.267 0.478-2.293 1.067-2.293s1.067 1.027 1.067 2.293zM20.449 12.152c0 1.267-0.477 2.293-1.066 2.293s-1.066-1.027-1.066-2.293c0-1.267 0.477-2.293 1.066-2.293s1.066 1.027 1.066 2.293zM22.238 17.156h-1.13c0 0.594 0.22 1.139 0.578 1.574-0.384 0.964-2.686 2.171-5.686 2.171-2.999 0-5.302-1.206-5.686-2.171 0.356-0.435 0.579-0.98 0.579-1.574h-1.131c0 0.796-0.705 1.444-1.57 1.444v1.131c0.438 0 0.847-0.111 1.214-0.289 0.83 1.393 3.389 2.589 6.594 2.589 3.206 0 5.765-1.196 6.594-2.589 0.366 0.178 0.776 0.289 1.214 0.289v-1.131c-0.865 0-1.57-0.648-1.57-1.444zM31.788 26.090c-0.338-0.628-0.631-0.754-1.181-0.925-0.472-0.143-1.302-0.076-2.017 0.202-0.163 0.064-0.31 0.167-0.466 0.251-0.463 0.248-0.742 0.2-1.094-0.177-0.202-0.218-0.837-0.791-1.709-1.618 1.779-2.117 2.853-4.842 2.853-7.823 0-2.98-1.074-5.706-2.853-7.823 0.871-0.826 1.505-1.398 1.707-1.617 0.352-0.377 0.631-0.425 1.094-0.176 0.155 0.083 0.303 0.186 0.466 0.249 0.714 0.279 1.544 0.345 2.017 0.201 0.548-0.169 0.842-0.295 1.181-0.924 0.207-0.485 0.284-0.912 0.132-1.456-0.151-0.541-0.771-0.888-1.55-1.023-0.625-0.109-0.368-0.211-0.379-0.771-0.016-0.84-0.317-1.5-1.033-1.948-0.542-0.336-1.163-0.363-1.763-0.341-0.826 0.027-1.677 0.435-1.886 0.926-0.248 0.58 0.031 0.954 0.258 1.369 0.294 0.531 0.15 1.062-0.23 1.505-0.411 0.482-1.421 1.519-1.996 2.131-2.041-1.547-4.579-2.477-7.339-2.477-2.761 0-5.299 0.93-7.341 2.478-0.575-0.613-1.585-1.65-1.996-2.133-0.38-0.443-0.523-0.975-0.23-1.506 0.228-0.414 0.506-0.788 0.26-1.368-0.21-0.492-1.061-0.899-1.887-0.926-0.6-0.023-1.223 0.004-1.765 0.341-0.715 0.447-1.018 1.108-1.033 1.947-0.010 0.561 0.247 0.663-0.379 0.772-0.779 0.134-1.397 0.482-1.55 1.022-0.151 0.543-0.075 0.972 0.132 1.456 0.338 0.628 0.632 0.756 1.181 0.925 0.472 0.144 1.303 0.076 2.018-0.201 0.163-0.065 0.31-0.168 0.466-0.249 0.463-0.249 0.741-0.202 1.094 0.174 0.203 0.22 0.837 0.793 1.707 1.618-1.779 2.117-2.852 4.844-2.852 7.823 0 2.981 1.075 5.709 2.853 7.825-0.87 0.826-1.504 1.399-1.707 1.617-0.354 0.377-0.631 0.425-1.094 0.177-0.155-0.084-0.303-0.187-0.466-0.251-0.715-0.279-1.546-0.345-2.018-0.202-0.548 0.17-0.842 0.296-1.181 0.925-0.207 0.485-0.284 0.912-0.132 1.456 0.153 0.541 0.771 0.888 1.55 1.023 0.626 0.109 0.369 0.211 0.379 0.771 0.016 0.84 0.318 1.5 1.033 1.948 0.542 0.336 1.164 0.363 1.765 0.341 0.826-0.025 1.677-0.435 1.887-0.926 0.247-0.579-0.032-0.955-0.26-1.369-0.293-0.529-0.15-1.061 0.23-1.505 0.411-0.481 1.421-1.519 1.996-2.132 2.042 1.548 4.58 2.478 7.341 2.478s5.298-0.93 7.339-2.478c0.575 0.613 1.587 1.651 1.997 2.132 0.38 0.444 0.523 0.976 0.23 1.505-0.229 0.414-0.506 0.79-0.26 1.369 0.21 0.491 1.061 0.901 1.887 0.926 0.601 0.022 1.223-0.006 1.765-0.341 0.715-0.448 1.016-1.108 1.032-1.948 0.012-0.56-0.246-0.662 0.38-0.771 0.777-0.135 1.397-0.482 1.548-1.023 0.152-0.543 0.075-0.971-0.133-1.456zM16.001 27.421c-6.298 0-11.421-5.123-11.421-11.421 0-6.297 5.123-11.42 11.421-11.42 6.295 0 11.42 5.124 11.42 11.42 0 6.298-5.125 11.421-11.42 11.421z"></path>
            </svg><br>arXiv
        </a>
        <a href="https://github.com/jhacsonmeza/MarkerPose" target="_blank">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
            </svg><br>Code
        </a>
        <a href="https://drive.google.com/drive/folders/1abZWgODq2XpUyIZclIMR59ldTdKFfqie?usp=sharing" target="_blank">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-zip" viewBox="0 0 16 16">
                <path d="M5 7.5a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v.938l.4 1.599a1 1 0 0 1-.416 1.074l-.93.62a1 1 0 0 1-1.11 0l-.929-.62a1 1 0 0 1-.415-1.074L5 8.438V7.5zm2 0H6v.938a1 1 0 0 1-.03.243l-.4 1.598.93.62.929-.62-.4-1.598A1 1 0 0 1 7 8.438V7.5z"/>
                <path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1h-2v1h-1v1h1v1h-1v1h1v1H6V5H5V4h1V3H5V2h1V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"/>
            </svg><br>Data
        </a>
    </div>



    <div class="section">
        <h1>
            Abstract
        </h1>
        <p align="justify">
            We propose a three-dimensional (3D) multimodal medical imaging system that combines freehand ultrasound and structured light 3D reconstruction in a single coordinate system without requiring registration. To the best of our knowledge, these techniques have not been combined as a multimodal imaging technique. The system complements the internal 3D information acquired with ultrasound with the external surface measured with the structured light technique. Moreover, the ultrasound probe's optical tracking for pose estimation was implemented based on a convolutional neural network. Experimental results show the system's high accuracy and reproducibility, as well as its potential for preoperative and intraoperative applications. The experimental multimodal error, or the distance from two surfaces obtained with different modalities, was 0.12 mm. The code is available in a Github repository.
        </p>
    </div>
    


    <div class="section">
        <h1>
            Overview
        </h1>
        <p align="justify">
            Our proposed multimodal system is shown in <b>Fig. 1</b> which consists of two cameras, a DLP projector, and a B-mode ultrasound (US) machine. The figure shows the main coordinate frames involved in the multimodal imaging technique.
        </p>

        <figure>
            <img class="zoom-fig" src="figures/multimodal_diagram.png" alt="multimodal diagram" style="width: 50%;">
            <figcaption><b>Figure 1.</b> Multimodal 3D imaging system composed of two cameras, a projector and a US machine.</figcaption>
        </figure>

        <p align="justify">
            The main idea is to obtain the external surface of the patient or zone of interest with the structure light technique using \( \{Cam_1\} \) and the projector \( \{P\} \), and the internal structure with the 3D freehand ultrasound method by mapping the ultrasound slides \( \{I\} \) to the 3D space using \( \{Cam_1\} \) and \( \{Cam_2\} \) to track the pose of a target \( \{T\} \) attached to the ultrasound transducer. 3D data acquired from both modalities are referred to \( \{Cam_1\} \) coordinate system which is also the world \( \{W\} \) frame for structure light and freehand ultrasound techniques.
            <br>
            <br>The reconstruction pipeline is described in <b>Fig. 2</b>, where in a first stage fringe patterns are projected onto the region of interest to obtain the 3D surface. In a second stage, we acquire US images from the internal structure of interest for 3D reconstruction with freehand ultrasound. For this technique we use the stereo vision system \( \{Cam_1\} \) and \( \{Cam_2\} \), a marker of three circles, and <a href="https://github.com/jhacsonmeza/MarkerPose">MarkerPose</a>: a sub-pixel center detection method based on deep learning for pose estimation of the ultrasound probe. Then, in this second stage, as input we have the stereo images of the marker, and an ultrasound slice which is mapped to the 3D space.
        </p>

        <figure>
            <img class="zoom-fig" src="figures/method.png" alt="reconstruction_pipeline" style="width: 100%;">
            <figcaption><b>Figure 2.</b> The proposed multimodal 3D imaging pipeline with the external 3D surface and internal US images.</figcaption>
        </figure>
    </div>
    



    <div class="section">
        <h1>
            Breast Phantom Results
        </h1>

        <p>
            For multimodal evaluation, we used a breast phantom <a href="https://www.3bscientific.com/sonotrain-breast-model-with-tumours-1019635-p125-3b-scientific,p_1397_27469.html">3B SONOtrain P125</a> consisting of three tumors:
        </p>

        <figure>
            <img class="zoom-fig" src="figures/breast_model.png" alt="breast phantom model" style="width: 80%;">
            <figcaption><b>Figure 3.</b> Breast phantom model used for multimodal reconstruction.</figcaption>
        </figure>

        <p>
            The experimental setup for this experiment is shown in the following image:
        </p>

        <figure>
            <img class="zoom-fig" src="figures/exp_setup.jpg" alt="experimental setup" style="width: 80%;">
            <figcaption><b>Figure 4.</b> Experimental setup for the breast phantom experiment.</figcaption>
        </figure>

        <p>
            The acquisition process for external and internal reconstruction is shown below:
        </p>

        <figure>
            <video src="figures/phan_sl_us_acq.mp4" controls loop muted playsinline width=80%></video>
            <figcaption><b>Video 1.</b> Acquisition stages for multimodal reconstruction.</figcaption>
        </figure>

        <p>
            which leads to the following multimodal results (set the opacity to 1 to see the texture of the external surface):
        </p>

        <div id="pantom-cont" class="cont3d">
            <div id="phantom" class="viz3d"></div>
        </div>
    </div>




    <div class="section">
        <h1>
            Concentric Cylinders Results
        </h1>

        <p>
            We also built an experiment consisting of two concentric cylinders, where the inner cylinder is submerged in water to be measured with freehand ultrasound.
        </p>

        <figure>
            <img class="zoom-fig" src="figures/cylinders_model.png" alt="concentric cylinders model" style="width: 80%;">
            <figcaption><b>Figure 5.</b> Measured object: outer and inner cylinders.</figcaption>
        </figure>

        <p>
            For the first stage we project fringe patterns:
        </p>

        <figure>
            <video src="figures/cyl_sl_acq.mp4" controls loop muted playsinline width=70%></video>
            <figcaption><b>Video 2.</b> Fringe projection onto the external cylinder.</figcaption>
        </figure>

        <p>
            For the second stage, the ultrasound images are acquired and the pose of the marker is estimated:
        </p>

        <figure>
            <video src="figures/cyl_us_acq.mp4" controls loop muted playsinline width=100%></video>
            <figcaption><b>Video 3.</b> Ultrasound slices acquisition of the internal tumor.</figcaption>
        </figure>

        <p>
            The multimodal results of the internal and external cylindrical objects are seen below:
        </p>

        <div id="cylinders-cont" class="cont3d">
            <div id="cylinders" class="viz3d"></div>
        </div>
    </div>



    <div class="section">
        <h1>
            Potential Applications: Navigation System
        </h1>

        <p>
            As we can obtain the pose of the marker in real-time, we can use this for medical navigation by displaying the ultrasound images and the 3D model of a transducer in a 3D real-time visualizer.
        </p>

        <figure>
            <video src="figures/navigation.mp4" controls loop muted playsinline width=80%></video>
            <figcaption><b>Video 4.</b> Multimodal technique as a navigation system.</figcaption>
        </figure>

        <p>
            For navigation purposes, we developed a real-time visualization software using OpenCV 3D Visualizer, where we merge MarkerPose with the stereo visualization of the cameras.
        </p>

        <figure>
            <video src="../figures/navig_acq.mp4" controls loop muted playsinline width=100%></video>
            <figcaption><b>Video 5.</b> Example of the navigation visualization system.</figcaption>
        </figure>
    </div>


    <div class="section">
        <h1>
            Potential Applications: Projection-based Guidance
        </h1>

        <p>
            In addition to using the projector for fringe projection, we can exploit it to point out the location of the tumors.
        </p>

        <figure>
            <img class="zoom-fig" src="figures/proj1.png" alt="concentric cylinders model" style="width: 50%;">
            <figcaption><b>Figure 6.</b> Using the projector to highlight the location of the tumors.</figcaption>
        </figure>

        <p>
            We can also project the reconstructed tumors with the ultrasound slices onto the phantom surface including their texture. This as a first step towards projection-based augmented reality guidance. Note that the projected tumors are in agreement with the actual position and texture of the tumors.
        </p>

        <figure>
            <img class="zoom-fig" src="figures/proj2.png" alt="concentric cylinders model" style="width: 100%;">
            <figcaption><b>Figure 7.</b> Towards projection-based augmented reality applications.</figcaption>
        </figure>
    </div>



    <div class="section">
        <h1>
            Citation
        </h1>
<pre><code>@article{meza2021three,
  title={Three-dimensional multimodal medical imaging system based on freehand ultrasound and structured light},
  author={Meza, Jhacson and Contreras-Ortiz, Sonia H and Romero, Lenny A and Marrugo, Andres G},
  journal={Optical Engineering},
  volume={60},
  number={5},
  pages={054106},
  year={2021},
  publisher={International Society for Optics and Photonics}
}</code></pre>
    </div>



    <div class="section">
        <h1>
            Acknowledgments
        </h1>
        <p align="justify">
            This work has been partly funded by Universidad Tecnológica de Bolívar project C2018P005. Jhacson Meza thanks Universidad Tecnológica de Bolívar for a post-graduate scholarship and MinCiencias, and MinSalud for a “Joven Talento” scholarship.
        </p>
    </div>
    
</body>
</html>